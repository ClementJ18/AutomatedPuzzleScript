\chapter{Appendix}
\label{ch:appendix}

\section{Appendix A}
This is a collection of errors that the JavaScript implementation of PuzzleScript raises. These were used in our project to reverse-engineering PuzzleScript's design. The messages that appear below are ripped straight from the JavaScript code. We have, however, removed duplicate messages. We wanted to centralize the messages for future works and to have an easy reference to them.

\subsection{Errors}
\begin{enumerate}
    \item "'random' cannot be matched on the left-hand side, it can only appear on the right", rule.lineNumber
    \item "A rule has to have an arrow in it.  There's no arrow here! Consider reading up about rules - you're clearly doing something weird", lineNumber
    \item "An ellipsis on the left must be matched by one in the corresponding place on the right.", rule.lineNumber
    \item "An ellipsis on the right must be matched by one in the corresponding place on the left.", rule.lineNumber
    \item "Background must be in a layer by itself.",state.lineNumber
    \item "Cannot define a property (using 'or') in terms of aggregates (something that uses 'and').", state.lineNumber
    \item "Cannot define an aggregate (using 'and') in terms of properties (something that uses 'or').", state.lineNumber
    \item "Commands should only appear at the end of rules, not in or before the pattern-detection/-replacement sections.", lineNumber
    \item "Error, an \item can only have one direction/action at a time, but you're looking for several at once!", lineNumber
    \item "Expecting sfx data, instead found "" + seed + "".", lineNumber
    \item "Got caught looping lots in a rule group :O",ruleGroup[0].lineNumber,true
    \item "Movements cannot appear in late rules.", lineNumber
    \item "Need have to have matching number of  'startLoop' and 'endLoop' loop points."
    \item "No collision layers defined.  All objects need to be in collision layers."
    \item "Oops!  " + object\_name.toUpperCase() + " not assigned to a layer.", rule.lineNumber
    \item "Something bad's happening in the LEGEND", state.lineNumber
    \item "The start of a rule must consist of some number of directions (possibly 0), before the first bracket, specifying in what directions to look (with no direction specified, it applies in all four directions).  It seems you've just entered "" + token.toUpperCase() + '".', lineNumber
    \item "There can't be more than 30 rigid groups (rule groups containing rigid members).", rules[0][0][3]
    \item "There's no point in putting an ellipsis at the very start or the end of a rule", rule.lineNumber
    \item "Trying to access color number "+n+" from the color palette of sprite " +state.objects\_candname.toUpperCase()+", but there are only "+o.colors.length+" defined in it.",state.lineNumber
    \item "You can't define object " + candname.toUpperCase() + " in terms of itself!", state.lineNumber
    \item "You can't have anything in with an ellipsis. Sorry.", rule.lineNumber
    \item "You can't use two ellipses in a single cell match pattern.  If you really want to, please implement it yourself and send me a patch :) ", oldrule.lineNumber
    \item "You cannot use 'no' to exclude the aggregate object " + c.toUpperCase() + " (defined using 'AND'), only regular objects, or properties (objects defined using 'OR').  If you want to do this, you'll have to write it out yourself the long way.", lineNumber
    \item "You have an totally empty pattern on the left-hand side.  This will match *everything*.  You certainly don't want this."
    \item "a sprite cannot have more than 10 colors.  Why you would want more than 10 is beyond me.", o.lineNumber + 1
    \item "background cannot be an aggregate (declared with 'and'), it has to be a simple type, or property (declared in terms of others using 'or')."
    \item "error detected - unexpected character " + stream.peek(),state.lineNumber
    \item "error, didn't find any object called player, either in the objects section, or the legends section. there must be a player!"
    \item "got caught in an endless startloop...endloop vortex, escaping!", ruleGroup[0].lineNumber,true
    \item "have to have matching number of  'startLoop' and 'endLoop' loop points."
    \item "no layers found.",state.lineNumber
    \item "spooky ellipsis found! (should never hit this)"
    \item "too much stuff to define a sound event.", lineNumber
    \item "you have to define something to be the background"
    \item "you have to have a background layer"
    \item '"'+n+'" is an aggregate (defined using "and"), and cannot be added to a single layer because its constituent objects must be able to coexist.', state.lineNumber
    \item 'Cannot add "' + candname.toUpperCase() + '" to a collision layer; it has not been declared.', state.lineNumber
    \item 'Cannot end a rule with ellipses.', lineNumber
    \item 'Cannot reference "' + candname.toUpperCase() + '" in the LEGEND section; it has not been defined yet.', state.lineNumber
    \item 'Encountered an unexpected "->" inside square brackets.  It's used to separate states, it has no place inside them >:| .', lineNumber
    \item 'Error in win condition: "' + candword.toUpperCase() + '" is not a valid object name.', state.lineNumber
    \item 'Error, malformed cell rule - encountered a "["" before previous bracket was closed', lineNumber
    \item 'Error, malformed cell rule - was looking for cell contents, but found "' + token + '".  What am I supposed to do with this, eh, please tell me that.', lineNumber
    \item 'Error, symbol "' + ch + '" is defined using 'or', and therefore ambiguous - it cannot be used in a map. Did you mean to define it in terms of 'and'?', level[0] + j
    \item 'Error, symbol "' + ch + '", used in map, not found.', level[0] + j
    \item 'Error, when specifying a rule, the number of matches (square bracketed bits) on the left hand side of the arrow must equal the number on the right', lineNumber
    \item 'Error, you can only use "->" once in a rule; it's used to separate before and after states.', lineNumber
    \item 'Expecting the word "ON" but got "'+candword.toUpperCase()+"'.", state.lineNumber
    \item 'Identifiers cannot appear outside of square brackets in rules, only directions can.', state.lineNumber
    \item 'In a rule, each pattern to match on the left must have a corresponding pattern on the right of equal length (number of cells).', lineNumber
    \item 'In a rule, if you specify a force, it has to act on an object.', lineNumber
    \item 'Invalid character "' + ch + '" in sprite for ' + state.objects\_candname.toUpperCase(), state.lineNumber
    \item 'Invalid color specified for object "' + n + '", namely "' + o.colors[i] + '".', o.lineNumber + 1
    \item 'Key "' + ch.toUpperCase() + '" not found. Do you need to add it to the legend, or define a new object?', state.lineNumber
    \item 'MetaData "'+token+'" has no parameters.',state.lineNumber
    \item 'MetaData "'+token+'" needs a value.',state.lineNumber
    \item 'Name "' + candname.toUpperCase() + '" already in use.', state.lineNumber
    \item 'Name "' + m + '", referred to in a rule, does not exist.', state.lineNumber
    \item 'No levels found.  Add some levels!', undefined, true
    \item 'Object "' + candname.toUpperCase() + '" defined multiple times.', state.lineNumber
    \item 'Object "' + n.toUpperCase() + '" has been defined, but not assigned to a layer.', dat.lineNumber
    \item 'Object "' + target + '" not found.', lineNumber
    \item 'Object "'+n+'" has been declared to be multiple different things',state.legend\_aggregates[i].lineNumber
    \item 'Object not found with name ' + n, state.lineNumber
    \item 'Palette "' + val + '" not found, defaulting to arnecolors.', 0
    \item 'Rule matches object types that can't overlap: "' + object\_name.toUpperCase() + '" and "' + existingname.toUpperCase() + '".', rule.lineNumber
    \item 'Spooky error!  Empty line passed to rule function.', lineNumber
    \item 'Sprites must be 5 wide and 5 high.', state.lineNumber
    \item 'The "+" symbol, for joining a rule with the group of the previous rule, must be the first symbol on the line '
    \item 'The "+" symbol, for joining a rule with the group of the previous rule, needs a previous rule to be applied to.'
    \item 'This rule has a property on the right-hand side, "' + rhsPropertyRemains.toUpperCase() + "", that can't be inferred from the left-hand side.  (either for every property on the right there has to be a corresponding one on the left in the same cell, OR, if there's a single occurrence of a particular property name on the left, all properties of the same name on the right are assumed to be the same).", lineNumber
    \item 'This rule has an ambiguous movement on the right-hand side, "' + rhsAmbiguousMovementsRemain + "", that can't be inferred from the left-hand side.  (either for every ambiguous movement associated to an entity on the right there has to be a corresponding one on the left attached to the same entity, OR, if there's a single occurrence of a particular ambiguous movement on the left, all properties of the same movement attached to the same object on the right are assumed to be the same (or something like that)).", lineNumber
    \item 'This rule has some content of the form "X no X" which can never match and so the rule is getting removed during compilation.', rule.lineNumber
    \item 'This rule refers to nothing.  What the heck? :O', lineNumber
    \item 'Trying to define aggregate "' + n.toUpperCase() + '" in terms of property "' + value.toUpperCase() + '".'
    \item 'Trying to define property "' + n.toUpperCase() + '" in terms of aggregate "' + value.toUpperCase() + '".'
    \item 'Two "+"s ("append to previous rule group" symbol) applied to the same rule.', lineNumber
    \item 'Unknown junk in spritematrix for object ' + state.objects\_candname.toUpperCase() + '.', state.lineNumber
    \item 'Unrecognised stuff in the prelude.', state.lineNumber
    \item 'Unwelcome term "' + n1 + '" found in win condition. Win conditions objects have to be objects or properties (defined using "or", in terms of other properties)', lineNumber
    \item 'Was expecting a direction, instead found "' + direction + '".', lineNumber
    \item 'Was looking for color for object ' + state.objects\_candname.toUpperCase() + ', got "' + str + '" instead.', state.lineNumber
    \item 'You cannot use relative directions ("\^v<>") to indicate in which direction(s) a rule applies.  Use absolute directions indicators (Up, Down, Left, Right, Horizontal, or Vertical, for instance), or, if you want the rule to apply in all four directions, do not specify directions', lineNumber
    \item 'You need to have some objects defined'
    \item 'You want to spawn a random "' + object\_name.toUpperCase() + '", but I don't know how to do that', rule.lineNumber
    \item 'cannot assign sound events to aggregate objects (declared with "and"), only to regular objects, or properties, things defined in terms of "or" ("' + target + '").', lineNumber
    \item 'cannot duplicate sections (you tried to duplicate "' + state.section.toUpperCase() + '").', state.lineNumber
    \item 'color not specified for object "' + n + '".', o.lineNumber
    \item 'incorrect format of legend - should be one of A = B, A = B or C ( or D ...), A = B and C (and D ...)', state.lineNumber
    \item 'incorrect format of win condition.', state.lineNumber
    \item 'incorrect sound declaration.', lineNumber
    \item 'must start with section "OBJECTS"', state.lineNumber
    \item 'names cannot end with the letter "v", because it's is used as a direction.', state.lineNumber
    \item 'no such section as "' + state.section.toUpperCase() + '".', state.lineNumber
    \item 'section "' + state.section.toUpperCase() + '" is out of order, must follow  "' + sectionNames[sectionIndex - 1].toUpperCase() + '" (or it could be that the section "'+sectionNames[sectionIndex - 1].toUpperCase()+`"is just missing totally.  You have to include all section headings, even if the section itself is empty).`, state.lineNumber
    \item 'section "' + state.section.toUpperCase() + '" must be the first section', state.lineNumber
    \item 'unexpected sound token "'+candname+'".' , state.lineNumber
    \item example[0] + ' and ' + example[1] + ' can never overlap, but this rule requires that to happen.', rule.lineNumber
\end{enumerate}

\subsection{Warnings}
\begin{enumerate}
    \item "Author list too long to fit on screen, truncating to three lines.",undefined,true
    \item "Commands should only appear at the end of rules, not in or before the pattern-detection/-replacement sections.", lineNumber
    \item "Game title is too long to fit on screen, truncating to five lines.",undefined,true
    \item "Invalid syntax, ellipses should only be used within cells (square brackets).", lineNumber
    \item "Invalid syntax. Directions should be placed at the start of a rule.", lineNumber
    \item "Invalid token " + token.toUpperCase() + ". Object names should only be used within cells (square brackets).", lineNumber
    \item "Maps must be rectangular, yo (In a level, the length of each row must be the same).",state.lineNumber
    \item "Multiple closing brackets without corresponding opening brackets.  Something fishy here.  Every '[' has to be closed by a ']', and you can't nest them.", lineNumber
    \item "Sprite graphics must be 5 wide and 5 high exactly.", o.lineNumber
    \item "This rule may try to spawn a " + o1 + " with random, but also requires a " + o2 + " be here, which is on the same layer - they shouldn't be able to coexist!", rule.lineNumber
    \item "You probably meant to put a space after 'message' innit.  That's ok, I'll still interpret it as a message, but you probably want to put a space there.",state.lineNumber
    \item "throttle\_movement is designed for use in conjunction with realtime\_interval. Using it in other situations makes games gross and unresponsive, broadly speaking.  Please don't."
    \item 'A "restart" command is being triggered in the "run\_rules\_on\_level\_start" section of level creation, which would cause an infinite loop if it was actually triggered, but it's being ignored, so it's not.'
    \item 'Janky syntax.  "|" should only be used inside cell rows (the square brackety bits).', lineNumber
    \item 'Message too long to fit on screen.', level[2]
    \item 'Unknown junk in object section (possibly: sprites have to be 5 pixels wide and 5 pixels high exactly. Or maybe: the main names for objects have to be words containing only the letters a-z0.9 - if you want to call them something like ",", do it in the legend section).',state.lineNumber
    \item 'You named an object "' + candname.toUpperCase() + '", but this is a keyword. Don't do that!', state.lineNumber
\end{enumerate}

\pagebreak
\section{Appendix B}
A list of figures related to all the errors currently implemented within ScriptButler. Some of these errors are new and some are translations from the original PuzzleScript implementation.

\begin{table}[!htbp]
\centering
\caption{Invalid errors detected by the analyzer}
\label{tab:static_errors_invalid}
\scriptsize
\begin{tabular}{ll}
% \toprule
\textbf{Name} & \textbf{Description}                                                                    \\ \hline
% \midrule
invalid\_name                                       & Name does not respect the pattern rules defined for it                        \\
invalid\_color                                      & Color not found in the chosen palette                                          \\
invalid\_sound\_seed                                & Sound seed is not a valid positive int                                         \\
invalid\_sound\_verb                                & Sound verbs not recognized                                                     \\
invalid\_sprite                                     & Sprite is not 5*5                                                              \\
invalid\_level\_row                                 & Level rows are not all equal in length                                         \\
invalid\_sound\_length                              & Sound definition has too many/not enough verbs                                 \\
invalid\_condition\_length                          & Condition definition has too many/not enough verbs                             \\
invalid\_condition                                  & Combination of condition verbs not recognized                                  \\
invalid\_condition\_verb                            & Condition verbs not recognized                                                 \\
invalid\_object\_type                               & Mixed properties and aggregates in legend definition                           \\
invalid\_prelude\_key                               & Prelude keyword not recognized                                                 \\
invalid\_prelude\_value                             & Prelude value invalid for prelude keyword                                      \\
invalid\_rule\_prefix                               & Verb not valid as rule prefix                                                  \\
invalid\_rule\_command                              & Verb is not valid as a rule command                                            \\
invalid\_sound                                      & Verb is not a valid sound                                                      \\
invalid\_ellipsis\_placement                        & Ruleparts cannot start or end with ellipsis                                    \\
invalid\_ellipsis                                   & Ellipsis must be alone in the section                                          \\
invalid\_rule\_part\_size                           & Rules must have the same number of parts on each sides                         \\
invalid\_rule\_content\_size                        & Rule parts must have the same number of sections on each part                  \\
invalid\_rule\_keyword\_amount                      & Each force in a section must be applied to exactly one object                  \\
invalid\_rule\_keyword\_placement                   & Each force in a section must be applied to exactly one object                  \\
invalid\_rule\_ellipsis\_size                       & Ellipsis must be present in both parts at the same place                       \\
invalid\_rule\_movement\_late                       & Late rules cannot match for movements                                          \\
invalid\_rule\_random                               & Random keywords cannot be used on the left side                                \\
% \bottomrule
\end{tabular}
\end{table}

\begin{table}[!htbp]
\centering
\caption{Undefined errors detected by the analyzer}
\label{tab:static_errors_undefined}
\scriptsize
\begin{tabular}{ll}
% \toprule
\textbf{Name} & \textbf{Description}                                                                    \\ \hline
% \midrule
undefined\_reference                                & Reference used but never defined                                               \\
undefined\_object                                   & Object used but never defined                                                  \\
undefined\_sound\_seed                              & Sound seed does not exist                                                      \\
undefined\_sound\_mask                              & Sound mask used but never defined                                              \\
undefined\_sound\_objects                           & Object used but never defined                                                  \\
undefined\_sound                                    & Sound event used but never defined                                             \\
% \bottomrule
\end{tabular}
\end{table}

\begin{table}[!htbp]
\centering
\caption{Existing errors detected by the analyzer}
\label{tab:static_errors_existing}
\scriptsize
\begin{tabular}{ll}
% \toprule
\textbf{Name} & \textbf{Description}                                                                    \\ \hline
% \midrule
existing\_object                                    & Object has already been defined                                                \\
existing\_legend                                    & Legend has already been defined                                                \\
existing\_section                                   & Section has already been defined                                               \\
existing\_mask                                      & Mask has already been defined for this sound                                   \\
existing\_sound\_seed                               & Seed has already been defined for this sound                                   \\
existing\_sound\_object                             & Object has already been defined for this sound                                 \\
existing\_prelude\_key                              & Prelude keyword already defined                                                \\
% \bottomrule
\end{tabular}
\end{table}

\begin{table}[!htbp]
\centering
\caption{Misc errors detected by the analyzer}
\label{tab:static_errors_misc}
\scriptsize
\begin{tabular}{ll}
% \toprule
\textbf{Name} & \textbf{Description}                                                                    \\ \hline
% \midrule
mixed\_legend                                       & Legend has both 'or' and 'and'                                                 \\
mixed\_legend                                       & Property cannot use aggregates/Aggregates cannot use properties                \\
unlayered\_objects                                  & Object defined but not added to any collision layers                           \\
ambiguous\_pixel                                    & Properties cannot be used in levels                                            \\
reserved\_keyword                                   & Cannot use keyword there                                                       \\
self\_reference                                     & Legend references self                                                         \\
mask\_not\_directional                              & Direction keywords used but mask is not directional                            \\
impossible\_condition\_duplicates                   & Duplicate conditions found                                                     \\
impossible\_condition\_unstackable                  & Conditions require items that exist on the same layer to stack                 \\
missing\_prelude\_value                             & Prelude keyword requires a value                                               \\
% \bottomrule
\end{tabular}
\end{table}

\begin{table}[!htbp]
\centering
\caption{Warnings detected by the analyzer}
\label{tab:static_warnings}
\scriptsize
\begin{tabular}{ll}
% \toprule
\textbf{Name} & \textbf{Description}                                                                    \\ \hline
% \midrule
unused\_colors                                      & Color is defined for the object but never used in sprite                           \\
no\_levels                                          & No levels have been defined for the game                                       \\
message\_too\_long                                  & The message might be too long to display                                       \\
existing\_sound                                     & Sound event already registered, registering a new one                            \\
existing\_condition                                 & Similar win condition already exists                                           \\
existing\_rule                                      & Similar rule already exists                                                    \\
redundant\_prelude\_value                           & Prelude keyword does not require a value                                      \\
multilayered\_object                                & Objects appear in multiple layers                                              \\
semantic\_warning                                   & Object that needs to be on top for victory condition present in inferior layer \\
win\_keyword                                        & Win keyword in the rule makes other commands and rule parts useless                \\
% \bottomrule
\end{tabular}
\end{table}
